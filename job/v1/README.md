# Build Type: Buildkite job

This is a [SLSA Provenance](https://slsa.dev/provenance/v1) `buildType` that
describes the execution of a [Buildkite](https://buildkite.com) pipelines job.

## Description

```jsonc
"buildType": "https://buildkite.github.io/slsa-buildtypes/job/v1"
```

This `buildType` describes the execution of a [Buildkite] pipeline job that
builds a software artifact.

[Buildkite]: https://buildkite.com

## Build Definition

### External parameters

[Buildkite environment]: https://buildkite.com/docs/pipelines/environment-variables

All external parameters are REQUIRED unless empty. They are sourced from within the runner's [Buildkite environment].

<table>
<tr><th>Parameter<th>Type<th>Description

<tr id="pipeline"><td><code>pipeline</code><td>string<td>

The Buildkite pipeline URL for the step being run.

<tr id="repository"><td><code>repository</code><td>string<td>

The repository URL as configured on the pipeline.

<tr id="build.branch"><td><code>build.branch</code><td>string<td>

The build branch as supplied when the build was created.

<tr id="build.tag"><td><code>build.tag</code><td>string<td>

The build tag as supplied when the build was created, if the build is for a tag. <code>null</code> otherwise.

<tr id="build.commit"><td><code>build.commit</code><td>string<td>

The build commit as supplied when the build was created, or which may have been resolved into a concrete sha for this step.

<tr id="step.key"><td><code>step.key</code><td>string<td>

The unique key for this step, if configured. <code>null</code> otherwise.

<tr id="step.command"><td><code>step.command</code><td>string<td>

The command to be run for this step.

</table>

### Internal parameters

All internal parameters are OPTIONAL.

| Parameter   | Type     | Description |
| ---------   | -------- | ----------- |
| `buildkite` | object   | |

The `buildkite` object SHOULD contains the following elements:

| Buildkite Parameter         | Type   | Description |
| --------------------------- | ------ | ----------- |
| `buildkite.organization_id` | string | The resolved ID of the organization containing the build. |
| `buildkite.pipeline_id`     | string | The resolved ID of the pipeline containing the build. |

IDs are used here to provide stable identifiers across organization and pipeline renames and to detect when an old name is reused for a new entity.

### Resolved dependencies

The `resolvedDependencies` SHOULD contain an entry identifying the resolved
git commit ID corresponding to `externalParameters.repository` and
`externalParameters.build`. The dependency's `uri` MUST be in [SPDX Download
Location] format, i.e.  `"git+" + workflow.uri + "@" + workflow.ref`.
See [Examples](#examples).

The `resolvedDependencies` MAY contain additional artifacts known to be input to
the workflow, such as the specific versions of the virtual environments used.

[SPDX Download Location]: https://spdx.github.io/spdx-spec/v2.3/package-information/#77-package-download-location-field

## Run details

### Builder

The `builder.id` MUST represent the entity that generated the provenance, as per
the [SLSA Provenance](https://slsa.dev/provenance/v1#builder.id) documentation.
In practice, this is likely one of the following:

-   When the provenance is generated by a [Buildkite plugin], the `builder.id`
    SHOULD be set to the [SPDX Download Location] of the plugin source.
    Example: `https://github.com/buildkite-plugins/npm-provenance-buildkite-plugin@refs/tags/v0.0.1`
-   When the provenance is generated by Buildkite, the `builder.id` SHOULD be
    set to a URI representing Buildkite.
    Example: `https://agent.buildkite.com`

[Buildkite plugin]: https://buildkite.com/docs/plugins

### Metadata

The `invocationId` SHOULD be set to `"https://buildkite.com/" + organization_slug + "/" + pipeline_slug + "/builds/" + build_number + "#" + job_id`

## Examples

See [example.json](example.json).

## Version history

### v1

Initial version
